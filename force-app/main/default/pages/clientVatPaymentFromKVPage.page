<apex:page docType="html-5.0" standardController="VAT_Payment__c" extensions="clientVatPaymentFromKVBulkCreate" recordSetVar="siList">
    <apex:form >
        <apex:pageBlock >
            <apex:pageBlockTable value="{!wrapperList}" var="wrap">
                <apex:column headerValue="Name" value="{!wrap.record.Name}" style="width:450px"/>
                <apex:column headerValue="Amount Held on Account" value="{!wrap.amountHeldOnAccount}" style="width:450px"/>
                <apex:column headerValue="VAT Amount" style="width:450px">
                    <apex:input value="{!wrap.userAmount}" type="number"/>
                </apex:column>
            </apex:pageBlockTable>
            <br/><br/>
            <div align="center">
                <table>
                    <tr>
                        <td>
                            <center>
                                Payment Date: &nbsp; &nbsp; 
                                <apex:input type="date" value="{!selectedDate}" required="true"/> &nbsp; &nbsp; &nbsp;
                                Journal Description: &nbsp; &nbsp; 
                                <apex:input type="text" value="{!selectedJournalDescription}" required="true"/> &nbsp; &nbsp; &nbsp;
                                From Bank Account: &nbsp; &nbsp;
                                <apex:selectList value="{!selectedFromBankAccount}" size="1" required="true">
                                    <apex:selectOptions value="{!items}"/>
                                </apex:selectList> &nbsp; &nbsp; &nbsp;
                                To Bank Account: &nbsp; &nbsp;
                                <apex:selectList value="{!selectedToBankAccount}" size="1" required="true">
                                    <apex:selectOptions value="{!items}"/>
                                </apex:selectList>
                                <br/>
                                <apex:commandButton value="Create" action="{!generateKT}" oncomplete="showToast()" reRender="messagePanel"/>
                            </center>
                            <apex:outputPanel id="messagePanel" >
                                <apex:outputPanel id="sucessMsg" rendered="{!NOT(isErrorReturn)}">
                                    <script>
                                    function showToast(){
                                        sforce.one.showToast({
                                            "title": "Success!",
                                            "message":  "{!siCount} Payments created.",
                                            "type": "Success"
                                        });
                                        window.history.back();
                                    }
                                    </script>	
                                </apex:outputPanel>
                                <apex:outputPanel id="errorMsg" rendered="{!isErrorReturn}">
                                    <script>
                                    function showToast(){
                                        console.log("Error: ", '{!errorMessageReturn}');
                                        sforce.one.showToast({
                                            "title": "Error!",
                                            "message": "{!errorMessageReturn}",
                                            "type": "Error"
                                        });
                                    }
                                    //window.history.back();
                                    </script>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </td>
                    </tr>
                </table>
            </div>
        </apex:pageBlock>
    </apex:form>
    
</apex:page>